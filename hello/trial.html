<!doctype html>
<html class="no-js" lang=""> 
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>PayUmoney | Payments </title>
  <base href="/citruspage/" />
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
  .page-loader-wrap{background-color:#a5c339;height:100%;width:100%;position:fixed;z-index:99999;top:0;left:0}.page-loader-wrap.hide{display:none;}.page-loader-wrap .loader-content{max-width:320px;width:100%;margin-right:auto;margin-left:auto;margin-top:80px;text-align:center}.page-loader-wrap .loading-text{font-size:20px;font-size:1.25rem;color:#fff;margin-bottom:10px}.pageloader{background:url(../../images/payment/payment/pageloader.gif) no-repeat;display:inline-block;height:16px;width:105px}
  </style>
  <link rel="stylesheet" href="//media.dev.payumoney.com/media/css/payment/payment.css">
  <script>window.ignoreOpenLoginFlag = true;window.n_p = true;</script>

  <script type="text/javascript">

    window.ajaxRequest = function () {
       var activexmodes=["Msxml2.XMLHTTP", "Microsoft.XMLHTTP"]; //activeX versions to check for in IE
       if (window.ActiveXObject){ //Test for support for ActiveXObject in IE first (as XMLHttpRequest in IE7 is broken)
        for (var i=0; i<activexmodes.length; i++){
         try {
          return new ActiveXObject(activexmodes[i]);
         }
         catch(e){
          //suppress error
         }
        }
       }
       else if (window.XMLHttpRequest) // if Mozilla, Safari etc
        return new XMLHttpRequest();
       else
        return false;
    };

    window.onload = function(){ 
      var ajxRequestObject =  window.ajaxRequest();
      var basePath = window.location.href;
      var pid = basePath.substr(basePath.lastIndexOf("/view/")+6);
      var apiUrl = '/payment/op/v1/redirect?_r='+Math.random()+'&paymentId='+pid;
      ajxRequestObject.open("GET", apiUrl);
      ajxRequestObject.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      ajxRequestObject.send(); 
      ajxRequestObject.onreadystatechange=function(res){
             if (ajxRequestObject.readyState==4){
              if (ajxRequestObject.status==200 || window.location.href.indexOf("http")==-1){
            	  var data = ajxRequestObject.responseText;
            	  if(typeof (data) != 'object')
            		  data = JSON.parse(data);
            	  
                  delete ajxRequestObject;
                  if(data.result.flag == 0){
                      if(window.isMobile){
                        window.location.href = data.result.mobilePageUrl;
                      }else{
                        window.location.href = data.result.pageUrl;
                      }
                    }               
              } else {
                console.log("An error has occured making the error request");
              }
             }
        }
  }; 
  </script>

</head>
<body>
  <div id="main-loader" class="page-loader-wrap">
    <div class="loader-content">
      <h4 class="loading-text">Please Wait. Loading...</h4>
      <span class="pageloader"></span>
    </div>
  </div>
  <div ui-view="">
  </div>
</body>
</html>